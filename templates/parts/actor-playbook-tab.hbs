{{!-- Playbook Tab: Playbook Features, Moment of Truth, Advancements --}}
<div class="tab playbook" data-group="primary" data-tab="playbook">
	<section class="sheet-tab playbook-tab">
		{{!-- Playbook-Specific Features (uses PbtA system's attribute renderer for proper editor support) --}}
		{{#if (objLen system.attrLeft)}}
		<div class="playbook-section playbook-section--features">
			<label class="section-title">{{localize "MASKS-SHEETS.PlaybookFeatures"}}</label>
			{{> "pbta.actor-attributes" attrs=system.attrLeft cssClass="cell--attributes-left playbook-features" owner=owner editable=editable}}
		</div>
		{{/if}}

		{{!-- Moment of Truth --}}
		<div class="playbook-section playbook-section--moment">
			<div class="section-header">
				<label class="section-title">{{system.attributes.momentOfTruth.label}}</label>
				<label class="moment-unlock-toggle">
					<input type="checkbox" name="system.attributes.momentUnlocked.value" {{checked system.attributes.momentUnlocked.value}} />
					<span>{{system.attributes.momentUnlocked.checkboxLabel}}</span>
				</label>
			</div>
			{{#if system.attributes.momentOfTruth.description}}
			<p class="section-description">{{system.attributes.momentOfTruth.description}}</p>
			{{/if}}
			{{editor system.attributes.momentOfTruth.value target="system.attributes.momentOfTruth.value" button=true owner=owner editable=editable}}
		</div>

		{{!-- Advancements --}}
		<div class="playbook-section playbook-section--advancements">
			<label class="section-title">{{system.attributes.advancements.label}}</label>
			{{#if system.attributes.advancements.description}}
			<p class="section-description">{{system.attributes.advancements.description}}</p>
			{{/if}}
			<ul class="advancements-list">
				{{#each system.attributes.advancements.options as |option optionKey|}}
				<li class="advancement-item">
					<label class="advancement-label" {{#if option.tooltip}}data-tooltip="{{option.tooltip}}" data-tooltip-direction="UP"{{/if}}>
						{{#if option.values}}
						<span class="advancement-checkboxes">
							{{#each option.values as |suboption suboptionKey|}}
							<input type="checkbox" class="advancement-check" name="system.attributes.advancements.options.{{optionKey}}.values.{{suboptionKey}}.value" {{checked suboption.value}} />
							{{/each}}
						</span>
						{{else}}
						<input type="checkbox" class="advancement-check" name="system.attributes.advancements.options.{{optionKey}}.value" {{checked option.value}} />
						{{/if}}
						{{#if (eq option.label "[Text]")}}
						<input type="text" class="advancement-custom-text" name="system.attributes.advancements.options.{{optionKey}}.userLabel" value="{{option.userLabel}}" placeholder="Custom advancement..." />
						{{else}}
						<span class="advancement-text">{{option.label}}</span>
						{{/if}}
					</label>
				</li>
				{{/each}}
			</ul>
		</div>

		{{!-- Later Advances --}}
		<div class="playbook-section playbook-section--later-advances">
			<label class="section-title">{{system.attributes.laterAdvances.label}}</label>
			{{#if system.attributes.laterAdvances.description}}
			<p class="section-description">{{system.attributes.laterAdvances.description}}</p>
			{{/if}}
			<ul class="advancements-list">
				{{#each system.attributes.laterAdvances.options as |option optionKey|}}
				<li class="advancement-item">
					<label class="advancement-label" {{#if option.tooltip}}data-tooltip="{{option.tooltip}}" data-tooltip-direction="UP"{{/if}}>
						{{#if option.values}}
						<span class="advancement-checkboxes">
							{{#each option.values as |suboption suboptionKey|}}
							<input type="checkbox" class="advancement-check" name="system.attributes.laterAdvances.options.{{optionKey}}.values.{{suboptionKey}}.value" {{checked suboption.value}} />
							{{/each}}
						</span>
						{{else}}
						<input type="checkbox" class="advancement-check" name="system.attributes.laterAdvances.options.{{optionKey}}.value" {{checked option.value}} />
						{{/if}}
						{{#if (eq option.label "[Text]")}}
						<input type="text" class="advancement-custom-text" name="system.attributes.laterAdvances.options.{{optionKey}}.userLabel" value="{{option.userLabel}}" placeholder="Custom advancement..." />
						{{else}}
						<span class="advancement-text">{{option.label}}</span>
						{{/if}}
					</label>
				</li>
				{{/each}}
			</ul>
		</div>
	</section>
</div>
