{{!-- Team Turn Cards HUD --------------------------------------------------}}

<div class="turncards-row" data-team-size="{{teamSize}}" data-max-turns="{{maxTurns}}">
    {{#if showTeamCard}}
    <div class="turncard-wrapper turncard-wrapper--team" data-team-card="1">
        <article class="turncard turncard--gm turncard--state-team" role="group" aria-label="Team pool">
            <div class="turncard__inner">
                <header class="turncard__status">
                    <div class="turncard__status-track"></div>
                    <span class="turncard__status-label">Team</span>
                </header>

                <div class="turncard__portrait turncard__portrait--gm">
                    <div class="turncard__team">
                        <div class="turncard__team-value" aria-live="polite">{{team}}</div>

                        <div class="turncard__team-controls">
                            <button type="button" class="turncard__team-btn" data-action="team-minus" {{#unless
                                teamCanEdit}}disabled{{/unless}} title="Spend 1 Team (Shift: 5)"
                                aria-label="Spend Team">
                                &minus;
                            </button>

                            <button type="button" class="turncard__team-btn" data-action="team-plus" {{#unless
                                teamCanEdit}}disabled{{/unless}} title="Add 1 Team (Shift: 5)" aria-label="Add Team">
                                +
                            </button>

                            <button type="button" class="turncard__team-btn turncard__team-btn--reset"
                                data-action="team-reset" {{#unless teamCanEdit}}disabled{{/unless}}
                                title="Reset Team to 0" aria-label="Reset Team">
                                ‚ü≤
                            </button>
                        </div>

                        {{#if gm}}
                        <button type="button" class="turncard__gm-btn turncard__gm-btn--gmturn" data-action="gm-turn"
                            aria-label="Advance cooldowns (GM turn)">
                            GM Turn
                        </button>
                        {{/if}}
                    </div>
                </div>

                <footer class="turncard__nameplate turncard__nameplate--team">
                    <div class="turncard__name" title="Team Pool">Team Pool</div>
                </footer>
            </div>
        </article>
    </div>
    {{/if}}

    {{#each cards as |card|}}
    <div class="turncard-wrapper" data-combatant-id="{{card.combatantId}}">
        <article
            class="turncard turncard--state-{{card.status}} {{#if card.onCooldown}}is-cooldown{{/if}} {{#if card.downed}}is-downed{{/if}}"
            data-combatant-id="{{card.combatantId}}" data-actor-id="{{card.actorId}}" role="button" tabindex="0"
            aria-label="{{card.ariaLabel}}" {{#if card.downedId}}aria-describedby="{{card.downedId}}" {{/if}}>
            <div class="turncard__inner">
                <header class="turncard__status">
                    <div class="turncard__status-track"></div>
                    <div class="turncard__cooldown-fill" style="--masks-turncards-cooldown-frac:{{card.cooldownFrac}};">
                    </div>
                    <span class="turncard__status-label">{{card.statusLabel}}</span>
                </header>

                <div class="turncard__portrait">
                    <img src="{{card.img}}" alt="{{card.name}}" loading="lazy" />
                </div>

                <footer class="turncard__nameplate">
                    <div class="turncard__name" title="{{card.name}}">
                        {{card.name}}
                    </div>
                </footer>

                <button type="button" class="turncard__pentagon" data-action="placeholder-pentagon"
                    aria-label="Future feature placeholder">
                    <i class="fa-thin fa-circle"></i>
                </button>

                <button type="button"
                    class="turncard__potential {{#unless card.canEditPotential}}turncard__potential--disabled{{/unless}}"
                    data-action="potential"
                    aria-label="Adjust potential (currently {{card.potential}} of {{card.potentialMax}})"
                    style="--masks-turncards-potential-fill:{{card.potentialPct}};">
                    <i class="fa-solid fa-star"></i>
                </button>

                {{#if card.downed}}
                <div class="turncard__downed" id="{{card.downedId}}" role="status" aria-label="Downed">
                    <div class="turncard__downed-label">DOWNED</div>
                </div>
                {{/if}}
            </div>
        </article>

        {{#if card.canGmMarkTurn}}
        <button type="button" class="turncard__gm-btn" data-action="gm-mark-turn" data-actor-id="{{card.actorId}}"
            aria-label="Mark turn taken for {{card.name}}">
            Mark Turn Taken
        </button>
        {{/if}}
    </div>
    {{/each}}
</div>